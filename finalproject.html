<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">

    <title>Weather Search</title>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <link rel="stylesheet" href="css/finalproject.css" media="screen" charset="utf-8">

  </head>
  <body>
    <main>
      <button id="fog">Foggy</button>
      <button id="clear-sky">Clear Sky</button>
      <button id="snow">Snow</button>
      <button id="rain">Rain</button>
      <button id="thunderstorm">Thunderstorm</button>
      <button id="scattered-clouds">Scattered Clouds</button>

    <ul id="cities">

    </ul>
  </main>
  </body>

    <script>

    var url = "http://api.openweathermap.org/data/2.5/box/city?bbox=-120,47,-70,24,10&cluster=yes&appid=2de143494c0b295cca9337e1e96b00e0";
    $.get(url, resultsReceived);

    var wet = "";
    var allWeather = null;
    var results = [];
    var keyword = "fog";

    function resultsReceived(data) {
      allWeather = data;
    };

    function searchCitiesByWeather(weatherCondition) {
      if (allWeather == null) {
        alert("Weather data hasn't downloaded yet. Try again in a second.");
        return [];
      }

      wet = allWeather.list;
      for (var i = 0; i < wet.length; i++) {
        var weatherList = wet[i];
        for (var j = 0; j < weatherList.weather.length; j++) {
          var currentWeather = weatherList.weather[j].description;
          if (keyword==currentWeather){
            results.push(weatherList);
          }
        }
      }
      return results;
    };


document.querySelector("#fog").addEventListener("click", fogClicked);

  var list = document.querySelector("#cities");

    function fogClicked(event) {
      var foggyCities = searchCitiesByWeather("fog");

      for (var i = 0; i < foggyCities.length; i++) {
        var foggyCity = foggyCities[i].name;

          var newLi = document.createElement("li");
          newLi.className = "city";
          list.appendChild(newLi);

          var cityList = document.createElement("div");
          cityList.textContent = foggyCity;
          newLi.appendChild(cityList);
      }
    }

    </script>
</html>
