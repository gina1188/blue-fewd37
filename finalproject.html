<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">

    <title>Weather Search</title>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <link rel="stylesheet" href="css/finalproject.css" media="screen" charset="utf-8">
    <header>
      Weather Should I Go?
    </header>
  </head>
  <body>
    <main>
      <div id="firstrow">
        <button id="Clouds">Clouds</button>
        <button id="Clear">Clear</button>
        <button id="Snow">Snow</button>
        <button id="Rain">Rain</button>
      </div>
    </br>
    </br>
      <div id="secondrow">
        <button id="Mist">Mist</button>
        <button id="Haze">Haze</button>
        <button id="Fog">Fog</button>
        <button id="Drizzle">Drizzle</button>
      </div>
    <ul id="cities">

    </ul>
  </main>
  </body>

    <script>

    var url = "http://api.openweathermap.org/data/2.5/box/city?bbox=-128,47,-70,24,10&cluster=yes&appid=2de143494c0b295cca9337e1e96b00e0";
    $.get(url, resultsReceived);

    var wet = "";
    var allWeather = null;
    var results = [];

    function resultsReceived(data) {
      allWeather = data;
    };

    function searchCitiesByWeather(weatherCondition) {
      if (allWeather == null) {
        alert("Weather data hasn't downloaded yet. Try again in a second.");
        return [];
      }

      wet = allWeather.list;
      for (var i = 0; i < wet.length; i++) {
        var weatherList = wet[i];
        for (var j = 0; j < weatherList.weather.length; j++) {
          var currentWeather = weatherList.weather[j].main;
          //console.log('currentWeather', currentWeather);
          if (weatherCondition==currentWeather){
            results.push(weatherList);
          }
        }
      }
      return results;
    };

document.querySelector("#Clouds").addEventListener("click", weatherClicked);
document.querySelector("#Clear").addEventListener("click", weatherClicked);
document.querySelector("#Snow").addEventListener("click", weatherClicked);
document.querySelector("#Rain").addEventListener("click", weatherClicked);
document.querySelector("#Mist").addEventListener("click", weatherClicked);
document.querySelector("#Haze").addEventListener("click", weatherClicked);
document.querySelector("#Fog").addEventListener("click", weatherClicked);
document.querySelector("#Drizzle").addEventListener("click", weatherClicked);

  var list = document.querySelector("#cities");

    function weatherClicked(event) {
      event.preventDefault
      //console.log(event);

      var weatherCities = searchCitiesByWeather(event.srcElement.id);

      for (var i = 0; i < weatherCities.length; i++) {
        var weatherCity = weatherCities[i].name;

          var newLi = document.createElement("li");
          newLi.className = "city";
          list.appendChild(newLi);

          var cityList = document.createElement("div");
          cityList.textContent = weatherCity;
          newLi.appendChild(cityList);
      }
    }

    </script>
</html>
